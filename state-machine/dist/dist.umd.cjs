(function(e,i){typeof exports=="object"&&typeof module<"u"?i(exports):typeof define=="function"&&define.amd?define(["exports"],i):(e=typeof globalThis<"u"?globalThis:e||self,i(e.dist={}))})(this,function(e){"use strict";var l=Object.defineProperty;var c=(e,i,n)=>i in e?l(e,i,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[i]=n;var h=(e,i,n)=>(c(e,typeof i!="symbol"?i+"":i,n),n);class i{constructor(){h(this,"_listeners",{});h(this,"_onceListeners",{})}on(t,s){this._listeners[t]||(this._listeners[t]=new Set),this._listeners[t].add(s)}off(t,s){this._listeners[t]&&(this._listeners[t].delete(s),this._listeners[t].size===0&&delete this._listeners[t])}once(t,s){this._onceListeners[t]||(this._onceListeners[t]=new Set),this._onceListeners[t].add(s)}offOnce(t,s){this._onceListeners[t]&&(this._onceListeners[t].delete(s),this._onceListeners[t].size===0&&delete this._onceListeners[t])}emit(t,s){if(this._listeners[t])for(const r of[...this._listeners[t]])r(s);if(this._onceListeners[t]){for(const r of[...this._onceListeners[t]])r(s);delete this._onceListeners[t]}}removeAllListeners(){this._listeners={},this._onceListeners={}}}class n{constructor(t,s,r){h(this,"_state");h(this,"_data");h(this,"_handlers");h(this,"_emitter",new i);this._state=t,this._data=s,this._handlers=r}state(){return this._state}data(){return{...this._data}}emitter(){return this._emitter}event(t){this._handlers[this._state].onEvent(t,this.data(),this)}transition(t){this._state!==void 0&&this._handlers[this._state].onLeave(),this._state=t,this._handlers[t].onEnter(this.data(),this),this._emitter.emit("state",this.state())}setData(t){return this._data={...this._data,...t},this._emitter.emit("data",this.data()),this._data}}e.StateMachineBuilder=void 0,(_=>{function t(){const s={};let r=null,d=null;return{state(o){return r=o,this},data(o){return d=o,this},handle(o,a){return a.onEnter||(a.onEnter=()=>{}),a.onEvent||(a.onEvent=()=>{}),a.onLeave||(a.onLeave=()=>{}),s[o]=a,this},build(){return new n(r,d,s)}}}_.create=t})(e.StateMachineBuilder||(e.StateMachineBuilder={})),e.StateMachine=n,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})});
