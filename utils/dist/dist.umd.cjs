(function(o,l){typeof exports=="object"&&typeof module<"u"?l(exports):typeof define=="function"&&define.amd?define(["exports"],l):(o=typeof globalThis<"u"?globalThis:o||self,l(o.dist={}))})(this,function(o){"use strict";var L=Object.defineProperty;var S=(o,l,_)=>l in o?L(o,l,{enumerable:!0,configurable:!0,writable:!0,value:_}):o[l]=_;var c=(o,l,_)=>(S(o,typeof l!="symbol"?l+"":l,_),_);class l{constructor(){c(this,"_listeners",{});c(this,"_onceListeners",{})}on(e,t){this._listeners[e]||(this._listeners[e]=new Set),this._listeners[e].add(t)}off(e,t){this._listeners[e]&&(this._listeners[e].delete(t),this._listeners[e].size===0&&delete this._listeners[e])}once(e,t){this._onceListeners[e]||(this._onceListeners[e]=new Set),this._onceListeners[e].add(t)}offOnce(e,t){this._onceListeners[e]&&(this._onceListeners[e].delete(t),this._onceListeners[e].size===0&&delete this._onceListeners[e])}emit(e,t){if(this._listeners[e])for(const s of[...this._listeners[e]])s(t);if(this._onceListeners[e]){for(const s of[...this._onceListeners[e]])s(t);delete this._onceListeners[e]}}removeAllListeners(){this._listeners={},this._onceListeners={}}}class _{constructor(){c(this,"_types",new Map);c(this,"_history",[])}get(e){return this._get(e)}set(e,t){this._types.set(e,t)}_get(e,t=[]){if(!this._types.has(e)){if(this._history.includes(e)){const r=t.map(n=>n.name).join(" -> ");throw new Error(`Circular dependency detected for ${e.name}: ${r}`)}this._history.push(e);const s=new e(this);return this._types.set(e,s),this._history.pop(),s}return this._types.get(e)}}class h{constructor(e){c(this,"_iterable");this._iterable=e}static from(e){return new h(e)}static range(e){return new h(w(e))}static zip(...e){return new h(y(e))}static enumerate(e){return new h(b(e))}filter(e){return new h(p(this._iterable,e))}map(e){return new h(v(this._iterable,e))}enumerate(){return new h(b(this._iterable))}collect(){return Array.from(this._iterable)}[Symbol.iterator](){return this._iterable[Symbol.iterator]()}}function*p(i,e){for(const t of i)e(t)&&(yield t)}function*v(i,e){for(const t of i)yield e(t)}function*w(i){for(let e=0;e<i;e++)yield e}function*y(i){const e=new Array(i.length).fill(null),t=i.map(s=>s[Symbol.iterator]());for(;;){for(let s=0;s<i.length;s++){const n=t[s].next();if(n.done)return;e[s]=n.value}yield e}}function*b(i){let e=0;const t=new Array(2).fill(null);for(const s of i)t[0]=e,t[1]=s,yield t,e++}o.Transformer=void 0,(i=>{function e(r){return{map(n){return r(n)},event(n,u){u(r(n))}}}i.map=e,i.toString=e(r=>r.toString());function t(r){let n=null;return{map(u){return u},event(u,a){n!==null&&clearTimeout(n),n=setTimeout(()=>a(u),r,void 0)}}}i.debounce=t;function s(r){let n=0-r,u=null;return{map(a){return a},event(a,d){if(u!==null){u.value=a;return}const m=Date.now();if(n+r<m){n=m,d(a);return}u={value:a,timeout:setTimeout(()=>{const g=u===null?a:u.value;u=null,n=Date.now(),d(g)},r,void 0)}}}}i.throttle=s})(o.Transformer||(o.Transformer={})),(i=>{(e=>{function t(s,r){return{map(n){return r.map(s.map(n))},event(n,u){s.event(n,a=>r.event(a,u))}}}e.chain=t})(i.Utils||(i.Utils={}))})(o.Transformer||(o.Transformer={}));class f{constructor(e,t){c(this,"_value");c(this,"_subscribers",[]);c(this,"_dispatching",!1);c(this,"_pendingUnsubscribers",[]);c(this,"_destroyed",!1);c(this,"_onDestroy");this._value=e,this._onDestroy=t}get value(){return this._value}set value(e){if(this._destroyed){console.warn("Observable has been destroyed");return}e!==this._value&&(this._value=e,this.dispatch())}async next(){return new Promise(e=>{const t=this.subscribe(s=>{this.unsubscribe(t),e(s)},!1)})}dispatch(){this._dispatching=!0;for(const e of this._subscribers)e(this._value);for(this._dispatching=!1;this._pendingUnsubscribers.length>0;){const e=this._pendingUnsubscribers.pop(),t=this._subscribers.indexOf(e);t>-1&&this._subscribers.splice(t,1)}}subscribe(e,t=!0){return this._subscribers.push(e),t&&e(this._value),e}unsubscribe(e){if(this._dispatching){this._pendingUnsubscribers.push(e);return}const t=this._subscribers.indexOf(e);t>-1&&this._subscribers.splice(t,1)}map(e){const t=new f(e(this._value));return this.subscribe(s=>t.value=e(s)),t}pipe(e){return new f.Pipe(this,e)}destroy(){var e;this._destroyed||(this._subscribers=[],this._pendingUnsubscribers=[],this._destroyed=!0,(e=this._onDestroy)==null||e.call(this))}}(i=>{class e{constructor(s,r){this._observable=s,this._transformer=r}pipe(s){const r=o.Transformer.Utils.chain(this._transformer,s);return new e(this._observable,r)}observable(){const s=n=>{this._transformer.event(n,u=>r.value=u)},r=new i(this._transformer.map(this._observable.value),()=>this._observable.unsubscribe(s));return this._observable.subscribe(s,!1),r}}i.Pipe=e})(f||(f={})),(i=>{function e(s){const r=new i(void 0);return s.then(n=>r.value=n),r}i.fromPromise=e;function t(s){const r=setInterval(()=>n.value++,s,void 0),n=new i(0,()=>clearInterval(r));return n}i.interval=t})(f||(f={})),o.Emitter=l,o.Iter=h,o.Observable=f,o.Provider=_,Object.defineProperty(o,Symbol.toStringTag,{value:"Module"})});
