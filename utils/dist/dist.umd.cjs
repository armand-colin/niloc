(function(o,l){typeof exports=="object"&&typeof module<"u"?l(exports):typeof define=="function"&&define.amd?define(["exports"],l):(o=typeof globalThis<"u"?globalThis:o||self,l(o.dist={}))})(this,function(o){"use strict";var T=Object.defineProperty;var L=(o,l,_)=>l in o?T(o,l,{enumerable:!0,configurable:!0,writable:!0,value:_}):o[l]=_;var u=(o,l,_)=>(L(o,typeof l!="symbol"?l+"":l,_),_);class l{constructor(){u(this,"_listeners",{});u(this,"_onceListeners",{})}on(e,s){this._listeners[e]||(this._listeners[e]=new Set),this._listeners[e].add(s)}off(e,s){this._listeners[e]&&(this._listeners[e].delete(s),this._listeners[e].size===0&&delete this._listeners[e])}once(e,s){this._onceListeners[e]||(this._onceListeners[e]=new Set),this._onceListeners[e].add(s)}offOnce(e,s){this._onceListeners[e]&&(this._onceListeners[e].delete(s),this._onceListeners[e].size===0&&delete this._onceListeners[e])}emit(e,s){if(this._listeners[e])for(const t of[...this._listeners[e]])t(s);if(this._onceListeners[e]){for(const t of[...this._onceListeners[e]])t(s);delete this._onceListeners[e]}}removeAllListeners(){this._listeners={},this._onceListeners={}}}class _{constructor(){u(this,"_types",new Map);u(this,"_history",[]);u(this,"_lockEmitter",new l);u(this,"_locked",!1)}get(e){return this._get(e)}set(e,s){this._types.set(e,s)}lock(){if(this._locked)throw new Error("Trying to lock provider althrough it has already been locked.");this._locked=!0}unlock(){if(!this._locked)throw new Error("Trying to unlock provider althrough it has not been locked.");this._locked=!1}async _waitForRelease(){if(this._locked)return new Promise(e=>{const s=()=>{this._lockEmitter.off("unlock",s),e()};this._lockEmitter.on("unlock",s)})}async getAsync(e){if(await this._waitForRelease(),this._types.has(e))return this._types.get(e);this._addToHistory(e);const s=await e.asyncConstructor(this);return this._types.set(e,s),this._removeFromHistory(e),s}_addToHistory(e){if(this._history.includes(e)){const s=this._history.map(t=>t.name).join(" -> ");throw new Error(`Circular dependency detected for ${e.name}: ${s}`)}this._history.push(e)}_removeFromHistory(e){const s=this._history.indexOf(e);s>-1&&this._history.splice(s,1)}_get(e){if(this._types.has(e))return this._types.get(e);this._addToHistory(e);const s=new e(this);return this._types.set(e,s),this._removeFromHistory(e),s}}class d{constructor(e){u(this,"_iterable");this._iterable=e}static from(e){return new d(e)}static range(e){return new d(g(e))}static zip(...e){return new d(p(e))}static enumerate(e){return new d(m(e))}filter(e){return new d(y(this._iterable,e))}map(e){return new d(v(this._iterable,e))}enumerate(){return new d(m(this._iterable))}collect(){return Array.from(this._iterable)}[Symbol.iterator](){return this._iterable[Symbol.iterator]()}}function*y(r,e){for(const s of r)e(s)&&(yield s)}function*v(r,e){for(const s of r)yield e(s)}function*g(r){for(let e=0;e<r;e++)yield e}function*p(r){const e=new Array(r.length).fill(null),s=r.map(t=>t[Symbol.iterator]());for(;;){for(let t=0;t<r.length;t++){const n=s[t].next();if(n.done)return;e[t]=n.value}yield e}}function*m(r){let e=0;const s=new Array(2).fill(null);for(const t of r)s[0]=e,s[1]=t,yield s,e++}o.Transformer=void 0,(r=>{function e(i){return{map(n){return i(n)},event(n,c){c(i(n))}}}r.map=e,r.toString=e(i=>i.toString());function s(i){let n=null;return{map(c){return c},event(c,a){n!==null&&clearTimeout(n),n=setTimeout(()=>a(c),i,void 0)}}}r.debounce=s;function t(i){let n=0-i,c=null;return{map(a){return a},event(a,b){if(c!==null){c.value=a;return}const w=Date.now();if(n+i<w){n=w,b(a);return}c={value:a,timeout:setTimeout(()=>{const k=c===null?a:c.value;c=null,n=Date.now(),b(k)},i,void 0)}}}}r.throttle=t})(o.Transformer||(o.Transformer={})),(r=>{(e=>{function s(t,i){return{map(n){return i.map(t.map(n))},event(n,c){t.event(n,a=>i.event(a,c))}}}e.chain=s})(r.Utils||(r.Utils={}))})(o.Transformer||(o.Transformer={}));class f{constructor(e,s){u(this,"_value");u(this,"_subscribers",[]);u(this,"_dispatching",!1);u(this,"_pendingUnsubscribers",[]);u(this,"_destroyed",!1);u(this,"_onDestroy");this._value=e,this._onDestroy=s}get value(){return this._value}set value(e){if(this._destroyed){console.warn("Observable has been destroyed");return}e!==this._value&&(this._value=e,this.dispatch())}async next(){return new Promise(e=>{const s=this.subscribe(t=>{this.unsubscribe(s),e(t)},!1)})}dispatch(){this._dispatching=!0;for(const e of this._subscribers)e(this._value);for(this._dispatching=!1;this._pendingUnsubscribers.length>0;){const e=this._pendingUnsubscribers.pop(),s=this._subscribers.indexOf(e);s>-1&&this._subscribers.splice(s,1)}}subscribe(e,s=!0){return this._subscribers.push(e),s&&e(this._value),e}unsubscribe(e){if(this._dispatching){this._pendingUnsubscribers.push(e);return}const s=this._subscribers.indexOf(e);s>-1&&this._subscribers.splice(s,1)}map(e){const s=new f(e(this._value));return this.subscribe(t=>s.value=e(t)),s}pipe(e){return new f.Pipe(this,e)}destroy(){var e;this._destroyed||(this._subscribers=[],this._pendingUnsubscribers=[],this._destroyed=!0,(e=this._onDestroy)==null||e.call(this))}}(r=>{class e{constructor(t,i){this._observable=t,this._transformer=i}pipe(t){const i=o.Transformer.Utils.chain(this._transformer,t);return new e(this._observable,i)}observable(){const t=n=>{this._transformer.event(n,c=>i.value=c)},i=new r(this._transformer.map(this._observable.value),()=>this._observable.unsubscribe(t));return this._observable.subscribe(t,!1),i}}r.Pipe=e})(f||(f={})),(r=>{function e(t){const i=new r(void 0);return t.then(n=>i.value=n),i}r.fromPromise=e;function s(t){const i=setInterval(()=>n.value++,t,void 0),n=new r(0,()=>clearInterval(i));return n}r.interval=s})(f||(f={}));class h{constructor(e){this.milliseconds=e}static split(e){const s=(e==null?void 0:e.milliseconds)??0,t=(e==null?void 0:e.seconds)??0,i=(e==null?void 0:e.minutes)??0,n=(e==null?void 0:e.hours)??0,c=(e==null?void 0:e.days)??0;return new h(s+t*1e3+i*1e3*60+n*1e3*60*60+c*1e3*60*60*24)}static milliseconds(e){return new h(e)}static seconds(e){return new h(e*1e3)}static minutes(e){return new h(e*60*1e3)}static hours(e){return new h(e*60*60*1e3)}static days(e){return new h(e*24*60*60*1e3)}get seconds(){return this.milliseconds/1e3}get minutes(){return this.milliseconds/(1e3*60)}get hours(){return this.milliseconds/(1e3*60*60)}get days(){return this.milliseconds/(1e3*60*60*24)}split(){let e=this.milliseconds;const s=e%1e3;e=(e-s)/1e3;const t=e%60;e=(e-t)/60;const i=e%60;e=(e-i)/60;const n=e%24;return e=(e-n)/24,{milliseconds:s,seconds:t,minutes:i,hours:n,days:e}}add(e){return new h(this.milliseconds+e.milliseconds)}subtract(e){return new h(this.milliseconds-e.milliseconds)}equals(e){return this.milliseconds===e.milliseconds}}o.Duration=h,o.Emitter=l,o.Iter=d,o.Observable=f,o.Provider=_,Object.defineProperty(o,Symbol.toStringTag,{value:"Module"})});
